<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–æ–π | MagicLink</title>
    <link rel="stylesheet" th:href="@{/css/style.css}"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
<nav class="navbar">
    <div class="nav-container">
        <div class="logo">MagicüîóLink</div>
        <div class="nav-links">
            <a href="/links" class="nav-link">–ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
            <a href="/settings" class="nav-link">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
            <a href="/logout" class="nav-link accent">–í—ã–π—Ç–∏</a>
        </div>
    </div>
</nav>

<div class="container edit-link-container">
    <div class="edit-link-header">
        <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ <span class="magic-text">—Å—Å—ã–ª–∫–æ–π</span></h1>
        <a th:href="${baseUrl} + '/' + ${link.shortId}" class="short-url" target="_blank" th:text="${link.shortId}"></a>
    </div>

    <form th:action="@{/links/{id}(id=${link.id})}" method="post" class="edit-link-form">
        <div class="form-group">
            <label>–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π URL</label>
            <input type="url"
                   name="originalUrl"
                   th:value="${link.originalUrl}"
                   class="input-field"
                   required>

            <label>–ö–æ—Ä–æ—Ç–∫–∏–π URL</label>
            <input type="text"
                   name="shortId"
                   th:value="${link.shortId}"
                   class="input-field"
                   required>
        </div>

        <div class="ad-settings">
            <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∫–ª–∞–º–æ–π</h3>

            <div th:if="${user.hasSubscription()}" class="subscription-settings">
                <label class="toggle-switch">
                    <input type="checkbox" name="noAds" th:checked="${link.noAds}">
                    <span class="slider"></span>
                </label>
                <span class="toggle-label">–û—Ç–∫–ª—é—á–∏—Ç—å —Ä–µ–∫–ª–∞–º—É –¥–ª—è —ç—Ç–æ–π —Å—Å—ã–ª–∫–∏</span>
                <p class="hint">–î–æ—Å—Ç—É–ø–Ω–æ –ø–æ –≤–∞—à–µ–π –ø–æ–¥–ø–∏—Å–∫–µ</p>
            </div>

            <div th:unless="${user.hasSubscription()}">
                <div th:if="${link.noAds}" class="ad-status">
                    <p class="success-text">‚úÖ –†–µ–∫–ª–∞–º–∞ –¥–ª—è —ç—Ç–æ–π —Å—Å—ã–ª–∫–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∞</p>
                </div>

                <div th:unless="${link.noAds}" class="purchase-options">
                    <p class="ad-warning">–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –ø–æ —Å—Å—ã–ª–∫–µ –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è —Ä–µ–∫–ª–∞–º–∞</p>
                    <div class="purchase-ad-removal">
                        <p class="offer-text">–£–±—Ä–∞—Ç—å —Ä–µ–∫–ª–∞–º—É –≤—Å–µ–≥–æ –∑–∞
                            <span class="price" th:text="${removalPrice} + ' ‚ÇΩ'"></span>
                        </p>
                        <form th:action="@{/links/{id}/purchase-ad-removal(id=${link.id})}" method="post">
                            <button type="submit" class="magic-button success small">
                                <span class="button-text">–ö—É–ø–∏—Ç—å –Ω–∞–≤—Å–µ–≥–¥–∞</span>
                                <div class="hover-effect"></div>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div class="link-stats">
            <div class="stat-item">
                <div class="stat-label">–°–æ–∑–¥–∞–Ω–æ</div>
                <div class="stat-value" th:text="${link.createdAt}"></div>
            </div>
            <div class="stat-item">
                <div class="stat-label">–ü–µ—Ä–µ—Ö–æ–¥–æ–≤</div>
                <div class="stat-value" th:text="${link.clicks}"></div>
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="magic-button small">
                <span class="button-text">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</span>
                <div class="hover-effect"></div>
            </button>
            <a th:href="@{/links}" class="magic-button outlined small">–û—Ç–º–µ–Ω–∏—Ç—å</a>
        </div>
    </form>

    <div class="danger-zone">
        <h3>–û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞</h3>
        <form th:action="@{/links/{id}/delete(id=${link.id})}" method="post">
            <button type="submit" class="magic-button danger small">
                <span class="button-text">–£–¥–∞–ª–∏—Ç—å —Å—Å—ã–ª–∫—É</span>
                <div class="hover-effect"></div>
            </button>
        </form>
    </div>
</div>
</body>
</html>